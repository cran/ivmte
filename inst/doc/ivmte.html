<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="data:text/css;charset=utf-8,%0A%40font%2Dface%20%7B%0Afont%2Dfamily%3A%20octicons%2Dlink%3B%0Asrc%3A%20url%28data%3Afont%2Fwoff%3Bcharset%3Dutf%2D8%3Bbase64%2Cd09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM%2B8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB%2FaFGpk3jaTY6xa8JAGMW%2FO62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v%2Bk%2F0an2i%2BitHDw3v2%2B9%2BDBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3%2FI7AtxEJLtzzuZfI%2BVVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy%2FLt7Kc%2B0vWY%2FgAgIIEqAN9we0pwKXreiMasxvabDQMM4riO%2BqxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw%2Bymhce7vwM9jSqO8JyVd5RH9gyTt2%2BJ%2FyUmYlIR0s04n6%2B7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv%2FocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi%2BW2%2BMjCzMIDApSwvXzC97Z4Ig8N%2FBxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh%2F8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT%2BAEjAwuDFpBmA9KMDEwMCh9i%2Fv8H8sH0%2F4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9%2FlqYwOGZxeUelN2U2R6%2BcArgtCJpauW7UQBqnFkUsjAY%2FkOU1cP%2BDAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl%2BvvmM%2FbyA48e6tWrKArm4ZJlCbdsrxksL1AwWn%2FyBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO%2F%2FsdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd%2F89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF%2B9JOS0nbaaYDCQfwCJ7Au3AHj%2BLO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm%2BEBXuAbHmIMSRMs%2B4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL%2BhD7C1xoaHeLJSEao0FEW14ckxC%2BTU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13%2F%2Blm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl%2B9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O%2FAdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB%2F%2F%2FAA8AAQAAAAAAAAAAAAAAAAABAAAAAA%3D%3D%29%20format%28%27woff%27%29%3B%0A%7D%0Abody%20%7B%0A%2Dwebkit%2Dtext%2Dsize%2Dadjust%3A%20100%25%3B%0Atext%2Dsize%2Dadjust%3A%20100%25%3B%0Acolor%3A%20%23333%3B%0Afont%2Dfamily%3A%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20%22Segoe%20UI%22%2C%20Arial%2C%20freesans%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0Afont%2Dsize%3A%2016px%3B%0Aline%2Dheight%3A%201%2E6%3B%0Aword%2Dwrap%3A%20break%2Dword%3B%0A%7D%0Aa%20%7B%0Abackground%2Dcolor%3A%20transparent%3B%0A%7D%0Aa%3Aactive%2C%0Aa%3Ahover%20%7B%0Aoutline%3A%200%3B%0A%7D%0Astrong%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%202em%3B%0Amargin%3A%200%2E67em%200%3B%0A%7D%0Aimg%20%7B%0Aborder%3A%200%3B%0A%7D%0Ahr%20%7B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Aheight%3A%200%3B%0A%7D%0Apre%20%7B%0Aoverflow%3A%20auto%3B%0A%7D%0Acode%2C%0Akbd%2C%0Apre%20%7B%0Afont%2Dfamily%3A%20monospace%2C%20monospace%3B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ainput%20%7B%0Acolor%3A%20inherit%3B%0Afont%3A%20inherit%3B%0Amargin%3A%200%3B%0A%7D%0Ahtml%20input%5Bdisabled%5D%20%7B%0Acursor%3A%20default%3B%0A%7D%0Ainput%20%7B%0Aline%2Dheight%3A%20normal%3B%0A%7D%0Ainput%5Btype%3D%22checkbox%22%5D%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0Apadding%3A%200%3B%0A%7D%0Atable%20%7B%0Aborder%2Dcollapse%3A%20collapse%3B%0Aborder%2Dspacing%3A%200%3B%0A%7D%0Atd%2C%0Ath%20%7B%0Apadding%3A%200%3B%0A%7D%0A%2A%20%7B%0Abox%2Dsizing%3A%20border%2Dbox%3B%0A%7D%0Ainput%20%7B%0Afont%3A%2013px%20%2F%201%2E4%20Helvetica%2C%20arial%2C%20nimbussansl%2C%20liberationsans%2C%20freesans%2C%20clean%2C%20sans%2Dserif%2C%20%22Apple%20Color%20Emoji%22%2C%20%22Segoe%20UI%20Emoji%22%2C%20%22Segoe%20UI%20Symbol%22%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%234078c0%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%2C%0Aa%3Aactive%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200%3B%0Amargin%3A%2015px%200%3B%0Aoverflow%3A%20hidden%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23ddd%3B%0A%7D%0Ahr%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ahr%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%2015px%3B%0Amargin%2Dbottom%3A%2015px%3B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%2030px%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%2021px%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%2016px%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%2014px%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%2011px%3B%0A%7D%0Ablockquote%20%7B%0Amargin%3A%200%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Aol%20ol%2C%0Aul%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Droman%3B%0A%7D%0Aul%20ul%20ol%2C%0Aul%20ol%20ol%2C%0Aol%20ul%20ol%2C%0Aol%20ol%20ol%20%7B%0Alist%2Dstyle%2Dtype%3A%20lower%2Dalpha%3B%0A%7D%0Add%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Afont%2Dsize%3A%2012px%3B%0A%7D%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0Afont%3A%2012px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0A%7D%0A%2Eselect%3A%3A%2Dms%2Dexpand%20%7B%0Aopacity%3A%200%3B%0A%7D%0A%2Eocticon%20%7B%0Afont%3A%20normal%20normal%20normal%2016px%2F1%20octicons%2Dlink%3B%0Adisplay%3A%20inline%2Dblock%3B%0Atext%2Ddecoration%3A%20none%3B%0Atext%2Drendering%3A%20auto%3B%0A%2Dwebkit%2Dfont%2Dsmoothing%3A%20antialiased%3B%0A%2Dmoz%2Dosx%2Dfont%2Dsmoothing%3A%20grayscale%3B%0A%2Dwebkit%2Duser%2Dselect%3A%20none%3B%0A%2Dmoz%2Duser%2Dselect%3A%20none%3B%0A%2Dms%2Duser%2Dselect%3A%20none%3B%0Auser%2Dselect%3A%20none%3B%0A%7D%0A%2Eocticon%2Dlink%3Abefore%20%7B%0Acontent%3A%20%27%5Cf05c%27%3B%0A%7D%0A%2Emarkdown%2Dbody%3Abefore%20%7B%0Adisplay%3A%20table%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3Aafter%20%7B%0Adisplay%3A%20table%3B%0Aclear%3A%20both%3B%0Acontent%3A%20%22%22%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%20%21important%3B%0A%7D%0A%2Emarkdown%2Dbody%3E%2A%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%20%21important%3B%0A%7D%0Aa%3Anot%28%5Bhref%5D%29%20%7B%0Acolor%3A%20inherit%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0A%2Eanchor%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%2Dright%3A%202px%3B%0Amargin%2Dleft%3A%20%2D18px%3B%0A%7D%0A%2Eanchor%3Afocus%20%7B%0Aoutline%3A%20none%3B%0A%7D%0Ah1%2C%0Ah2%2C%0Ah3%2C%0Ah4%2C%0Ah5%2C%0Ah6%20%7B%0Amargin%2Dtop%3A%201em%3B%0Amargin%2Dbottom%3A%2016px%3B%0Afont%2Dweight%3A%20bold%3B%0Aline%2Dheight%3A%201%2E4%3B%0A%7D%0Ah1%20%2Eocticon%2Dlink%2C%0Ah2%20%2Eocticon%2Dlink%2C%0Ah3%20%2Eocticon%2Dlink%2C%0Ah4%20%2Eocticon%2Dlink%2C%0Ah5%20%2Eocticon%2Dlink%2C%0Ah6%20%2Eocticon%2Dlink%20%7B%0Acolor%3A%20%23000%3B%0Avertical%2Dalign%3A%20middle%3B%0Avisibility%3A%20hidden%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%2C%0Ah2%3Ahover%20%2Eanchor%2C%0Ah3%3Ahover%20%2Eanchor%2C%0Ah4%3Ahover%20%2Eanchor%2C%0Ah5%3Ahover%20%2Eanchor%2C%0Ah6%3Ahover%20%2Eanchor%20%7B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Ah1%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah2%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah3%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah4%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah5%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%2C%0Ah6%3Ahover%20%2Eanchor%20%2Eocticon%2Dlink%20%7B%0Avisibility%3A%20visible%3B%0A%7D%0Ah1%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%202%2E25em%3B%0Aline%2Dheight%3A%201%2E2%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah1%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah2%20%7B%0Apadding%2Dbottom%3A%200%2E3em%3B%0Afont%2Dsize%3A%201%2E75em%3B%0Aline%2Dheight%3A%201%2E225%3B%0Aborder%2Dbottom%3A%201px%20solid%20%23eee%3B%0A%7D%0Ah2%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%3B%0A%7D%0Ah3%20%7B%0Afont%2Dsize%3A%201%2E5em%3B%0Aline%2Dheight%3A%201%2E43%3B%0A%7D%0Ah3%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah4%20%7B%0Afont%2Dsize%3A%201%2E25em%3B%0A%7D%0Ah4%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E2%3B%0A%7D%0Ah5%20%7B%0Afont%2Dsize%3A%201em%3B%0A%7D%0Ah5%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ah6%20%7B%0Afont%2Dsize%3A%201em%3B%0Acolor%3A%20%23777%3B%0A%7D%0Ah6%20%2Eanchor%20%7B%0Aline%2Dheight%3A%201%2E1%3B%0A%7D%0Ap%2C%0Ablockquote%2C%0Aul%2C%0Aol%2C%0Adl%2C%0Atable%2C%0Apre%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%204px%3B%0Apadding%3A%200%3B%0Amargin%3A%2016px%200%3B%0Abackground%2Dcolor%3A%20%23e7e7e7%3B%0Aborder%3A%200%20none%3B%0A%7D%0Aul%2C%0Aol%20%7B%0Apadding%2Dleft%3A%202em%3B%0A%7D%0Aul%20ul%2C%0Aul%20ol%2C%0Aol%20ol%2C%0Aol%20ul%20%7B%0Amargin%2Dtop%3A%200%3B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Ali%3Ep%20%7B%0Amargin%2Dtop%3A%2016px%3B%0A%7D%0Adl%20%7B%0Apadding%3A%200%3B%0A%7D%0Adl%20dt%20%7B%0Apadding%3A%200%3B%0Amargin%2Dtop%3A%2016px%3B%0Afont%2Dsize%3A%201em%3B%0Afont%2Dstyle%3A%20italic%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Adl%20dd%20%7B%0Apadding%3A%200%2016px%3B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0Ablockquote%20%7B%0Apadding%3A%200%2015px%3B%0Acolor%3A%20%23777%3B%0Aborder%2Dleft%3A%204px%20solid%20%23ddd%3B%0A%7D%0Ablockquote%3E%3Afirst%2Dchild%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Ablockquote%3E%3Alast%2Dchild%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Atable%20%7B%0Adisplay%3A%20block%3B%0Awidth%3A%20100%25%3B%0Aoverflow%3A%20auto%3B%0Aword%2Dbreak%3A%20normal%3B%0Aword%2Dbreak%3A%20keep%2Dall%3B%0A%7D%0Atable%20th%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Atable%20th%2C%0Atable%20td%20%7B%0Apadding%3A%206px%2013px%3B%0Aborder%3A%201px%20solid%20%23ddd%3B%0A%7D%0Atable%20tr%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Aborder%2Dtop%3A%201px%20solid%20%23ccc%3B%0A%7D%0Atable%20tr%3Anth%2Dchild%282n%29%20%7B%0Abackground%2Dcolor%3A%20%23f8f8f8%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Abox%2Dsizing%3A%20content%2Dbox%3B%0Abackground%2Dcolor%3A%20%23fff%3B%0A%7D%0Acode%20%7B%0Apadding%3A%200%3B%0Apadding%2Dtop%3A%200%2E2em%3B%0Apadding%2Dbottom%3A%200%2E2em%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%2085%25%3B%0Abackground%2Dcolor%3A%20rgba%280%2C0%2C0%2C0%2E04%29%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0Acode%3Abefore%2C%0Acode%3Aafter%20%7B%0Aletter%2Dspacing%3A%20%2D0%2E2em%3B%0Acontent%3A%20%22%5C00a0%22%3B%0A%7D%0Apre%3Ecode%20%7B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Afont%2Dsize%3A%20100%25%3B%0Aword%2Dbreak%3A%20normal%3B%0Awhite%2Dspace%3A%20pre%3B%0Abackground%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0A%2Ehighlight%20%7B%0Amargin%2Dbottom%3A%2016px%3B%0A%7D%0A%2Ehighlight%20pre%2C%0Apre%20%7B%0Apadding%3A%2016px%3B%0Aoverflow%3A%20auto%3B%0Afont%2Dsize%3A%2085%25%3B%0Aline%2Dheight%3A%201%2E45%3B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0A%7D%0A%2Ehighlight%20pre%20%7B%0Amargin%2Dbottom%3A%200%3B%0Aword%2Dbreak%3A%20normal%3B%0A%7D%0Apre%20%7B%0Aword%2Dwrap%3A%20normal%3B%0A%7D%0Apre%20code%20%7B%0Adisplay%3A%20inline%3B%0Amax%2Dwidth%3A%20initial%3B%0Apadding%3A%200%3B%0Amargin%3A%200%3B%0Aoverflow%3A%20initial%3B%0Aline%2Dheight%3A%20inherit%3B%0Aword%2Dwrap%3A%20normal%3B%0Abackground%2Dcolor%3A%20transparent%3B%0Aborder%3A%200%3B%0A%7D%0Apre%20code%3Abefore%2C%0Apre%20code%3Aafter%20%7B%0Acontent%3A%20normal%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%2Dsize%3A%2011px%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Epl%2Dc%20%7B%0Acolor%3A%20%23969896%3B%0A%7D%0A%2Epl%2Dc1%2C%0A%2Epl%2Ds%20%2Epl%2Dv%20%7B%0Acolor%3A%20%230086b3%3B%0A%7D%0A%2Epl%2De%2C%0A%2Epl%2Den%20%7B%0Acolor%3A%20%23795da3%3B%0A%7D%0A%2Epl%2Ds%20%2Epl%2Ds1%2C%0A%2Epl%2Dsmi%20%7B%0Acolor%3A%20%23333%3B%0A%7D%0A%2Epl%2Dent%20%7B%0Acolor%3A%20%2363a35c%3B%0A%7D%0A%2Epl%2Dk%20%7B%0Acolor%3A%20%23a71d5d%3B%0A%7D%0A%2Epl%2Dpds%2C%0A%2Epl%2Ds%2C%0A%2Epl%2Ds%20%2Epl%2Dpse%20%2Epl%2Ds1%2C%0A%2Epl%2Dsr%2C%0A%2Epl%2Dsr%20%2Epl%2Dcce%2C%0A%2Epl%2Dsr%20%2Epl%2Dsra%2C%0A%2Epl%2Dsr%20%2Epl%2Dsre%20%7B%0Acolor%3A%20%23183691%3B%0A%7D%0A%2Epl%2Dv%20%7B%0Acolor%3A%20%23ed6a43%3B%0A%7D%0A%2Epl%2Did%20%7B%0Acolor%3A%20%23b52a1d%3B%0A%7D%0A%2Epl%2Dii%20%7B%0Abackground%2Dcolor%3A%20%23b52a1d%3B%0Acolor%3A%20%23f8f8f8%3B%0A%7D%0A%2Epl%2Dsr%20%2Epl%2Dcce%20%7B%0Acolor%3A%20%2363a35c%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dml%20%7B%0Acolor%3A%20%23693a17%3B%0A%7D%0A%2Epl%2Dmh%2C%0A%2Epl%2Dmh%20%2Epl%2Den%2C%0A%2Epl%2Dms%20%7B%0Acolor%3A%20%231d3e81%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmq%20%7B%0Acolor%3A%20%23008080%3B%0A%7D%0A%2Epl%2Dmi%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dstyle%3A%20italic%3B%0A%7D%0A%2Epl%2Dmb%20%7B%0Acolor%3A%20%23333%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmd%20%7B%0Abackground%2Dcolor%3A%20%23ffecec%3B%0Acolor%3A%20%23bd2c00%3B%0A%7D%0A%2Epl%2Dmi1%20%7B%0Abackground%2Dcolor%3A%20%23eaffea%3B%0Acolor%3A%20%2355a532%3B%0A%7D%0A%2Epl%2Dmdr%20%7B%0Acolor%3A%20%23795da3%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0A%2Epl%2Dmo%20%7B%0Acolor%3A%20%231d3e81%3B%0A%7D%0Akbd%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0Apadding%3A%203px%205px%3B%0Afont%3A%2011px%20Consolas%2C%20%22Liberation%20Mono%22%2C%20Menlo%2C%20Courier%2C%20monospace%3B%0Aline%2Dheight%3A%2010px%3B%0Acolor%3A%20%23555%3B%0Avertical%2Dalign%3A%20middle%3B%0Abackground%2Dcolor%3A%20%23fcfcfc%3B%0Aborder%3A%20solid%201px%20%23ccc%3B%0Aborder%2Dbottom%2Dcolor%3A%20%23bbb%3B%0Aborder%2Dradius%3A%203px%3B%0Abox%2Dshadow%3A%20inset%200%20%2D1px%200%20%23bbb%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20%7B%0Alist%2Dstyle%2Dtype%3A%20none%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%2B%2Etask%2Dlist%2Ditem%20%7B%0Amargin%2Dtop%3A%203px%3B%0A%7D%0A%2Etask%2Dlist%2Ditem%20input%20%7B%0Amargin%3A%200%200%2E35em%200%2E25em%20%2D1%2E6em%3B%0Avertical%2Dalign%3A%20middle%3B%0A%7D%0A%3Achecked%2B%2Eradio%2Dlabel%20%7B%0Az%2Dindex%3A%201%3B%0Aposition%3A%20relative%3B%0Aborder%2Dcolor%3A%20%234078c0%3B%0A%7D%0A%2EsourceLine%20%7B%0Adisplay%3A%20inline%2Dblock%3B%0A%7D%0Acode%20%2Ekw%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Edt%20%7B%20color%3A%20%23ed6a43%3B%20%7D%0Acode%20%2Edv%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ebn%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Efl%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Ech%20%7B%20color%3A%20%23009999%3B%20%7D%0Acode%20%2Est%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eco%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Eot%20%7B%20color%3A%20%230086b3%3B%20%7D%0Acode%20%2Eal%20%7B%20color%3A%20%23a61717%3B%20%7D%0Acode%20%2Efu%20%7B%20color%3A%20%2363a35c%3B%20%7D%0Acode%20%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%0Acode%20%2Ewa%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ecn%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Esc%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Evs%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Ess%20%7B%20color%3A%20%23183691%3B%20%7D%0Acode%20%2Eim%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eva%20%7Bcolor%3A%20%23008080%3B%20%7D%0Acode%20%2Ecf%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eop%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Ebu%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Eex%20%7B%20color%3A%20%23000000%3B%20%7D%0Acode%20%2Epp%20%7B%20color%3A%20%23999999%3B%20%7D%0Acode%20%2Eat%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Edo%20%7B%20color%3A%20%23969896%3B%20%7D%0Acode%20%2Ean%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ecv%20%7B%20color%3A%20%23008080%3B%20%7D%0Acode%20%2Ein%20%7B%20color%3A%20%23008080%3B%20%7D%0A" rel="stylesheet">
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="ivmte-an-r-package-for-marginal-treatment-effect-methods">ivmte: An R Package for Marginal Treatment Effect Methods</h1>
<p>Joshua Shea and Alexander Torgovitsky</p>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#scope-of-this-vignette">Scope of this Vignette</a></li>
<li><a href="#installation-and-requirements">Installation and Requirements</a></li>
<li><a href="#usage-demonstration">Usage Demonstration</a>
<ul>
<li><a href="#data-and-background">Data and Background</a></li>
<li><a href="#syntax-and-output-overview">Syntax and Output Overview</a></li>
<li><a href="#specifying-the-mtr-functions">Specifying the MTR Functions</a></li>
<li><a href="#specifying-the-target-parameter">Specifying the Target Parameter</a></li>
<li><a href="#specifying-the-iv--like-estimands">Specifying the IV--Like Estimands</a></li>
<li><a href="#specifying-the-propensity-score">Specifying the Propensity Score</a></li>
<li><a href="#point-identified-models">Point Identified Models</a></li>
<li><a href="#confidence-intervals">Confidence Intervals</a></li>
<li><a href="#specification-tests">Specification Tests</a></li>
</ul></li>
<li><a href="#help-feature-requests-and-bug-reports">Help, Feature Requests and Bug Reports</a></li>
<li><a href="#references">References</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Heckman and Vytlacil (2005) introduced the marginal treatment effect (MTE) to provide a choice-theoretic interpretation for the widely used instrumental variables model of Imbens and Angrist (1994). The MTE can be used to formally extrapolate from the compliers to estimate treatment effects for other subpopulations.</p>
<p>The <strong>ivmte</strong> package provides a flexible set of methods for conducting this extrapolation. The package uses the moment-based framework developed by Mogstad, Santos, and Torgovitsky (2018), which accommodates both point identification and partial identification (bounds), both parametric and nonparametric models, and allows the user to maintain additional shape constraints.</p>
<h2 id="scope-of-this-vignette">Scope of this Vignette</h2>
<p>This vignette is intended as a guide to using <strong>ivmte</strong> for users already familiar with MTE methods. The key defintions and concepts from that literature are used without further explanation. We have written a paper (Shea and Torgovitsky 2019) that discusses both the MTE methodology and the usage of <strong>ivmte</strong>, which should be helpful for users unfamiliar with MTE methods. The survey article by Mogstad and Torgovitsky (2018) provides additional theoretical background on MTE methods, including the moment-based implementation used in this module.</p>
<h2 id="installation-and-requirements">Installation and Requirements</h2>
<p><strong>ivmte</strong> can be installed from CRAN via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;ivmte&quot;</span>)</code></pre></div>
<p>If you have the <strong>devtools</strong> package, you can install the latest version of the module directly from our GitHub repository via</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;jkcshea/ivmte&quot;</span>)</code></pre></div>
<p>Two additional packages are also required for <strong>ivmte</strong>:</p>
<ol>
<li><strong>splines2</strong> for specifying models with polynomial splines. This package is available on CRAN.</li>
<li>A package for solving linear programs. There are three options here:
<ol>
<li>Gurobi and the Gurobi R package <strong>gurobi</strong>, which can be obtained from <a href="http://www.gurobi.com/index">Gurobi Optimization</a>. This option requires a Gurobi software license, which Gurobi Optimization offers at no cost to academic researchers.</li>
<li>CPLEX and the package <strong>cplexAPI</strong>, which is available on CRAN. CPLEX can be obtained from <a href="https://www.ibm.com/analytics/cplex-optimizer">IBM</a>. This option requires a software license, which IBM offers at no cost to academic researchers.</li>
<li>The <strong>lpSolveAPI</strong> package, which is free and open-source, and available from CRAN. Note that <strong>lpSolveAPI</strong> is a wrapper for <a href="http://lpsolve.sourceforge.net/5.5/">lp_solve</a>, which is no longer actively developed.</li>
</ol></li>
</ol>
<p><strong>ivmte</strong> tries to automatically choose a solver from those available, with preference being given to Gurobi and CPLEX. We have provided the option to use <strong>lpSolveAPI</strong> because it appears to be the only interface for solving linear programs that can be installed solely through <code>install.packages</code>. However, we <em>strongly</em> recommend using Gurobi or CPLEX, since these are actively developed, much more stable, and typically an order of magnitude faster than <strong>lpSolveAPI</strong>. A very clear installation guide for Gurobi can be found <a href="https://cran.r-project.org/package=prioritizr/vignettes/gurobi_installation.html">here</a></p>
<h2 id="usage-demonstration">Usage Demonstration</h2>
<h3 id="data-and-background">Data and Background</h3>
<p>We will use a subsample of 209133 women from the data used in Angrist and Evans (1998). The data is included with <strong>ivmte</strong> and has the following structure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ivmte)
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(AE, <span class="dt">n =</span> <span class="dv">10</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">worked</th>
<th align="right">hours</th>
<th align="right">morekids</th>
<th align="right">samesex</th>
<th align="right">yob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">52</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">45</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">35</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">49</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">51</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">40</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">40</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">44</td>
</tr>
</tbody>
</table>
<p>We will use these variables as follows:</p>
<ul>
<li><code>worked</code> is a binary outcome variable that indicates whether the woman was working.</li>
<li><code>hours</code> is a multivalued outcome variable that measures the number of hours the woman worked per week.</li>
<li><code>morekids</code> is a binary treatment variable that indicates whether a woman had more than two children or exactly two children.
<ul>
<li>Note that Angrist and Evans (1998) removed women with fewer than two children when constructing their sample.</li>
<li>Also note that the treatment variable must be binary.</li>
</ul></li>
<li><code>samesex</code> is an indicator for whether the woman's first two children had the same sex (male-male or female-female). This is used as an instrument for <code>morekids</code>.</li>
<li><code>yob</code> is the woman's year of birth (i.e. her age), which will be used as a conditioning variable.</li>
</ul>
<p>A goal of Angrist and Evans (1998) was to estimate the causal effect of <code>morekids</code> on either <code>worked</code> or <code>hours</code>. A linear regression of <code>worked</code> on <code>morekids</code> yields:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(<span class="dt">data =</span> AE, worked <span class="op">~</span><span class="st"> </span>morekids)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = worked ~ morekids, data = AE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)     morekids  </span>
<span class="co">#&gt;      0.5822      -0.1423</span></code></pre></div>
<p>The regression shows that women with three or more children are about 14--15% less likely to be working than women with exactly two children. Is this because children have a negative impact on a woman's labor supply? Or is it because women with a weaker attachment to the labor market choose to have more children?</p>
<p>Angrist and Evans (1998) address this question by using <code>samesex</code> as an instrument for <code>morekids</code>. We expect that <code>samesex</code> is randomly assigned, so that among women with two or more children, those with weak labor market attachment are just as likely as those with strong labor market attachment to have to have two boys or two girls for their first two children. A regression shows that women whose first two children had the same sex are also more likely to go on to have a third child:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(<span class="dt">data =</span> AE, morekids <span class="op">~</span><span class="st"> </span>samesex)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = morekids ~ samesex, data = AE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)      samesex  </span>
<span class="co">#&gt;     0.30214      0.05887</span></code></pre></div>
<p>Thus, <code>samesex</code> constitutes a potential instrumental variable for <code>morekids</code>. We can run a simple instrumental variable regression using the <code>ivreg</code> command from the <strong>AER</strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;AER&quot;</span>)
<span class="kw">ivreg</span>(<span class="dt">data =</span> AE, worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">|</span><span class="st"> </span>samesex )
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ivreg(formula = worked ~ morekids | samesex, data = AE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)     morekids  </span>
<span class="co">#&gt;     0.56315     -0.08484</span></code></pre></div>
<p>The coefficient on <code>morekids</code> is smaller in magnitude than it was in the linear regression of <code>worked</code> on <code>morekids</code>. This suggests that the linear regression overstates the negative impact that children have on a woman's labor supply. The likely explanation is that women who have more children were less likely to work anyway.</p>
<p>An important caveat to this reasoning, first discussed by Imbens and Angrist (1994), is that it applies only to the group of <em>compliers</em> who would have had a third child if and only if their first two children were same sex. (This interpretation requires the so-called <em>monotonicity</em> condition.) The first stage regression of <code>morekids</code> on <code>samesex</code> shows that this group comprises less than 6% of the entire population. Thus, the complier subpopulation is a small and potentially unrepresentative group of individuals.</p>
<p>Is the relationship between fertility and labor supply for the compliers the same as for other groups? The answer is important if we want to use an instrumental variable estimator to inform policy questions. The purpose of <strong>ivmte</strong> is to provide a formal framework for answering this type of extrapolation question.</p>
<hr />
<p>For demonstrating some of the features of <strong>ivmte</strong>, it will also be useful to use a simulated dataset. The following code, which is contained in <code>./extdata/ivmteSimData.R</code>, generates some simulated data from a simple DGP. The simulated data is also included with the package as <code>./data/ivmteSimData.rda</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
n &lt;-<span class="st"> </span><span class="dv">5000</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)
z &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">3</span>, .<span class="dv">5</span>)
x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">cut</span>(<span class="kw">rnorm</span>(n), <span class="dv">10</span>)) <span class="co"># normal discretized into 10 bins</span>
d &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(u <span class="op">&lt;</span><span class="st"> </span>z<span class="op">*</span>.<span class="dv">25</span> <span class="op">+</span><span class="st"> </span>.<span class="dv">01</span><span class="op">*</span>x)

v0 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) <span class="op">+</span><span class="st"> </span>.<span class="dv">2</span><span class="op">*</span>u
m0 &lt;-<span class="st"> </span><span class="dv">0</span>
y0 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(m0 <span class="op">+</span><span class="st"> </span>v0 <span class="op">+</span><span class="st"> </span>.<span class="dv">1</span><span class="op">*</span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)

v1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) <span class="op">-</span><span class="st"> </span>.<span class="dv">2</span><span class="op">*</span>u
m1 &lt;-<span class="st"> </span>.<span class="dv">5</span>
y1 &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(m1 <span class="op">+</span><span class="st"> </span>v1 <span class="op">-</span><span class="st"> </span>.<span class="dv">3</span><span class="op">*</span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)

y &lt;-<span class="st"> </span>d<span class="op">*</span>y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>d)<span class="op">*</span>y0

ivmteSimData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y,d,z,x)
knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(ivmteSimData, <span class="dt">n =</span> <span class="dv">10</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="right">d</th>
<th align="right">z</th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<h3 id="syntax-and-output-overview">Syntax and Output Overview</h3>
<p>The main command of the <strong>ivmte</strong> package is also called <code>ivmte</code>. It has the following basic syntax:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ivmte&quot;</span>)
results &lt;-<span class="st"> </span><span class="kw">ivmte</span>(<span class="dt">data =</span> AE,
                 <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
                 <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">ivlike =</span> worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
                 <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex)</code></pre></div>
<p>Here's what these required parameters refer to:</p>
<ul>
<li><code>data = AE</code> is the usual reference to the data to be used.</li>
<li><code>target = &quot;att&quot;</code> specifies the target parameter to be the average treatment on the treated (ATT).</li>
<li><code>m0</code> and <code>m1</code> are formulas specifying the MTR functions for the untreated and treated arms, respectively. The symbol <code>u</code> in the formula refers to the unobservable latent variable in the selection equation.</li>
<li><code>ivlike</code> indicates the regressions to be run to create moments to which the model is fit.</li>
<li><code>propensity</code> specifies a model for the propensity score.</li>
</ul>
<p>This is what happens when the code above is run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ivmte</span>(<span class="dt">data =</span> AE,
                 <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
                 <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">ivlike =</span> worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
                 <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex)
<span class="co">#&gt; </span>
<span class="co">#&gt; LP solver: Gurobi ('gurobi')</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Obtaining propensity scores...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Generating target moments...</span>
<span class="co">#&gt;     Integrating terms for control group...</span>
<span class="co">#&gt;     Integrating terms for treated group...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Generating IV-like moments...</span>
<span class="co">#&gt;     Moment 1...</span>
<span class="co">#&gt;     Moment 2...</span>
<span class="co">#&gt;     Moment 3...</span>
<span class="co">#&gt;     Moment 4...</span>
<span class="co">#&gt;     Independent moments: 4 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Performing audit procedure...</span>
<span class="co">#&gt;     Generating audit grid...</span>
<span class="co">#&gt;     Generating initial constraint grid...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Audit count: 1</span>
<span class="co">#&gt;     Minimum criterion: 0</span>
<span class="co">#&gt;     Obtaining bounds...</span>
<span class="co">#&gt;     Violations: 0</span>
<span class="co">#&gt;     Audit finished.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.09835591, -0.08285941]</span></code></pre></div>
<p>The <code>ivmte</code> function indicates its progress in performing a sequence of intermediate operations. It then runs through an audit procedure to enforce shape constraints. The audit procedure is described in more detail <a href="#audit">ahead</a>. After the audit procedure terminates, <code>ivmte</code> returns bounds on the target parameter, which in this case is the average treatment on the treated (<code>target = &quot;att&quot;</code>). These bounds are the primary output of interest. The detailed output can be suppressed by passing <code>noisy = FALSE</code> as an additional parameter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ivmte</span>(<span class="dt">data =</span> AE,
                 <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
                 <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">ivlike =</span> worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
                 <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
                 <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.09835591, -0.08285941]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<h3 id="specifying-the-mtr-functions">Specifying the MTR Functions</h3>
<h4 id="basics">Basics</h4>
<p>The required <code>m0</code> and <code>m1</code> arguments use the standard R formula syntax familiar from functions like <code>lm</code> or <code>glm</code>. However, the formulas involve an unobservable variable, <code>u</code>, which corresponds to the latent propensity to take treatment in the selection equation. This variable can be included in formulas in the same way as other observable variables in the data. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> AE,
             <span class="dt">ivlike =</span>  worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
             <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>yob <span class="op">+</span><span class="st"> </span>u<span class="op">*</span>yob,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>yob <span class="op">+</span><span class="st"> </span>u<span class="op">*</span>yob,
             <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.2987098, 0.1289499]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>A restriction that we make for computational purposes is that <code>u</code> can only appear in polynomial terms (perhaps interacted with other variables). Thus, the following raises an error</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;m0&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="kw">log</span>(u) <span class="op">+</span><span class="st"> </span>yob
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; Error: The following terms are not declared properly.</span>
<span class="co">#&gt;   m0: log(u) </span>
<span class="co">#&gt; The unobserved variable 'u' must be declared as a monomial, e.g. u, I(u^3). The monomial can be interacted with other variables, e.g. x:u, x:I(u^3). Expressions where the unobservable term is not a monomial are either not permissable or will not be parsed correctly, e.g. exp(u), I((x * u)^2). Try to rewrite the expression so that 'u' is only included in monomials.</span></code></pre></div>
<p>Names other than <code>u</code> can be used for the selection equation unobservable, but one must remember to pass the option <code>uname</code> to indicate the new name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;m0&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>v <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(v<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>yob <span class="op">+</span><span class="st"> </span>v<span class="op">*</span>yob
args[[<span class="st">&quot;m1&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>v <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(v<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(v<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>yob <span class="op">+</span><span class="st"> </span>v<span class="op">*</span>yob
args[[<span class="st">&quot;uname&quot;</span>]] &lt;-<span class="st"> &quot;v&quot;</span>
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.2987098, 0.1289499]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>There are some limitations regarding the use of factor variables. For example, the following formula for <code>m1</code> will trigger an error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;uname&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> &quot;u&quot;</span>
args[[<span class="st">&quot;m0&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob
args[[<span class="st">&quot;m1&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(yob)<span class="dv">55</span> <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(yob)<span class="dv">60</span></code></pre></div>
<p>However, one can work around this in a natural way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;m1&quot;</span>]] &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>(yob <span class="op">==</span><span class="st"> </span><span class="dv">55</span>) <span class="op">+</span><span class="st"> </span>(yob <span class="op">==</span><span class="st"> </span><span class="dv">60</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.09835591, -0.08285941]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<h4 id="polynomial-splines">Polynomial Splines</h4>
<p>In addition to global polynomials in <code>u</code>, <code>ivmte</code> also allows for polynomial splines in <code>u</code> using the keyword <code>uSplines</code>. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> AE,
             <span class="dt">ivlike =</span>  worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
             <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">2</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">2</span>, .<span class="dv">4</span>, .<span class="dv">6</span>, .<span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span>yob,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">3</span>, .<span class="dv">5</span>, .<span class="dv">7</span>))<span class="op">*</span>yob,
             <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.4479412, 0.2875447]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>The <code>degree</code> refers to the polynomial degree, so that <code>degree = 2</code> is a quadratic spline, and <code>degree = 3</code> is a cubic spline. Constant splines, which have an important role in some of the theory developed by Mogstad, Santos, and Torgovitsky (2018), can be implemented with <code>degree = 0</code>. The vector <code>knots</code> indicates the piecewise regions for the spline. Note that <code>0</code> and <code>1</code> are always automatically included as <code>knots</code>, so that only the interior knots need to be specified.</p>
<h4 id="shape-restrictions">Shape Restrictions</h4>
<p>One can also require the MTR functions to satisfy the following nonparametric shape restrictions.</p>
<ul>
<li>Boundedness of the MTR functions, via the parameters <code>m0.lb</code>, <code>m0.ub</code>, <code>m1.lb</code>, and <code>m1.ub</code>, which all take scalar values. In order to produce non-trivial bounds in cases of partial identification, <code>m0.lb</code> and <code>m1.lb</code> are by default set to the smallest value of the response variable (which is inferred from <code>ivlike</code>) that is observed in the data, while <code>m0.ub</code> and <code>m1.ub</code> are set to the largest value.</li>
<li>Boundedness of the MTE function, that is, <code>m1 - m0</code>, by setting <code>mte.lb</code> and <code>mte.ub</code>. By default, these are set to the values logically implied by the values for <code>m0.lb</code>, <code>m0.ub</code>, <code>m1.lb</code>, and <code>m1.ub</code>.</li>
<li>Monotonicity of the MTR functions in <code>u</code> for each value of the other observed variables, via the parameters <code>m0.dec</code>, <code>m0.inc</code>, <code>m1.dec</code>, <code>m1.inc</code>, which all take boolean values.</li>
<li>Monotonicity of the MTE function in <code>u</code>, via the parameters <code>mte.dec</code> and <code>mte.inc</code>.</li>
</ul>
<p>Here is an example with monotonicity restrictions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> AE,
             <span class="dt">ivlike =</span>  worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
             <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">2</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">2</span>, .<span class="dv">4</span>, .<span class="dv">6</span>, .<span class="dv">8</span>)) <span class="op">+</span><span class="st"> </span>yob,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">3</span>, .<span class="dv">5</span>, .<span class="dv">7</span>))<span class="op">*</span>yob,
             <span class="dt">m1.inc =</span> <span class="ot">TRUE</span>,
             <span class="dt">m0.inc =</span> <span class="ot">TRUE</span>,
             <span class="dt">mte.dec =</span> <span class="ot">TRUE</span>,
             <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.08827673, 0.2006589]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<h4 id="the-audit-procedure">The Audit Procedure</h4>
<p>The shape restrictions in the previous section are enforced by adding constraints to a linear program. It is difficult in general to ensure that a function satisfies restrictions such as boundedness or monotonicity, even if that function is known to be a polynomial. This difficulty is addressed in <strong>ivmte</strong> through an auditing procedure.</p>
<p>The auditing procedure is based on two grids: A relatively small <em>constraint grid</em>, and a relatively large <em>audit grid</em>. The MTR functions (and implied MTE function) are made to satisfy the specified shape restrictions on the constraint grid by adding constraints to the linear programs. While this ensures that the MTR functions satisfy the shape restrictions on the constraint grid, it does not ensure that they satisfy the restrictions &quot;everywhere.&quot; Thus, after solving the programs, we evaluate the solution MTR functions on the large audit grid, which is relatively inexpensive computationally. If there are points in the audit grid at which the solution MTRs violate the desired restrictions, then we add some of these points to the constraint grid and repeat the procedure. The procedure ends (the audit is passed), when the solution MTRs satisfy the constraints over the entire audit grid.</p>
<p>There are certain parameters that can be used to tune the audit procedure: The number of initial points in the constraint grid (<code>initgrid.nu</code> and <code>initgrid.nx</code>), the number of points in the audit grid (<code>audit.nu</code> and <code>audit.nx</code>), the maximum number of points that are added from the audit grid to the constraint grid (<code>audit.add</code>) for each constraint, and the maximum number of times the audit procedure is repeated before giving up (<code>audit.max</code>). We have tried to choose defaults for these parameters that should be suitable for most applications. However, if <code>ivmte</code> takes a very long time to run, one might want to try adjusting these parameters. Also, if <code>audit.max</code> is hit, which should be unlikely given the default settings, one should either adjust the settings or examine the <code>audit.grid$violations</code> field of the returned results to see the extent to which the shape restrictions are not satisfied.</p>
<h3 id="specifying-the-target-parameter">Specifying the Target Parameter</h3>
<p>The target parameter is the object the researcher wants to know. <strong>ivmte</strong> has built-in support for conventional target parameters and a class of generalized LATEs. It also has a system that allows users to construct their own target parameters by defining the associated weights.</p>
<h4 id="conventional-target-parameters">Conventional Target Parameters</h4>
<p>The target parameter can be set to the average treatment effect (ATE), average treatment on the treated (ATT), or the average treatment on the untreated by setting <code>target</code> to <code>ate</code>, <code>att</code>, or <code>atu</code>, respectively. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> AE,
             <span class="dt">ivlike =</span>  worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
             <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>yob <span class="op">+</span><span class="st"> </span>u<span class="op">*</span>yob,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>yob <span class="op">+</span><span class="st"> </span>u<span class="op">*</span>yob,
             <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.2987098, 0.1289499]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span>
args[[<span class="st">&quot;target&quot;</span>]] &lt;-<span class="st"> &quot;ate&quot;</span>
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.3800976, 0.2003928]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<h4 id="lates-and-generalized-lates">LATEs and Generalized LATEs</h4>
<p>LATEs can be set as target parameters by passing <code>target = late</code> and including named lists called <code>late.from</code> and <code>late.to</code>. The named lists should contain variable name and value pairs, where the variable names must also appear in the propensity score formula. Typically, one would choose instruments for these variables, although <code>ivmte</code> will let you include control variables as well. We demonstrate this using the simulated data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>z,
             <span class="dt">target =</span> <span class="st">&quot;late&quot;</span>,
             <span class="dt">late.from =</span> <span class="kw">c</span>(<span class="dt">z =</span> <span class="dv">1</span>),
             <span class="dt">late.to =</span> <span class="kw">c</span>(<span class="dt">z =</span> <span class="dv">3</span>),
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.6931532, -0.4397993]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>We can condition on covariates in the definition of the LATE by adding the named list <code>late.X</code> as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;late.X&quot;</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">2</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.8419396, -0.2913049]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span>
args[[<span class="st">&quot;late.X&quot;</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">8</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.7721625, -0.3209851]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<p><strong>ivmte</strong> also provides support for generalized LATEs, i.e. LATEs where the intervals of <code>u</code> that are being considered may or may not correspond to points in the support of the propensity score. These objects are useful for a number of extrapolation purposes, see e.g. Mogstad, Santos, and Torgovitsky (2018). They are set with <code>target = &quot;genlate&quot;</code> and the additional scalars <code>genlate.lb</code> and <code>genlate.ub</code>. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>z,
             <span class="dt">target =</span> <span class="st">&quot;genlate&quot;</span>,
             <span class="dt">genlate.lb =</span> .<span class="dv">2</span>,
             <span class="dt">genlate.ub =</span> .<span class="dv">4</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.7597831, -0.2984248]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span>
args[[<span class="st">&quot;genlate.ub&quot;</span>]] &lt;-<span class="st"> </span>.<span class="dv">41</span>
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.7551905, -0.3083199]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span>
args[[<span class="st">&quot;genlate.ub&quot;</span>]] &lt;-<span class="st"> </span>.<span class="dv">42</span>
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.7504255, -0.3182317]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>Generalized LATEs can also be made conditional-on-covariates by passing <code>late.X</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;late.X&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">x =</span> <span class="dv">2</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.867551, -0.2750135]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<h4 id="custom-target-parameters">Custom Target Parameters</h4>
<p>Since there are potentially a large and diverse array of target parameters that a researcher might be interested in across various applications, the <strong>ivmte</strong> package also allows the specification of custom target parameters. This is done by specifying the two weighting functions for the target parameters.</p>
<p>To facilitate computation, these functions must be expressible as constant splines in <code>u</code>. For the untreated weights, the knots of the spline are specified with <code>target.knots0</code> and the weights to place in between each knot is given by <code>target.weight0</code>. Since the weighting functions might depend on both the instrument and other covariates, both <code>target.knots0</code> and <code>target.weight0</code> should be lists consisting of functions or scalars. (A scalar is interpreted as a constant function.) Specifying the treated weights works the same way but with <code>target.knots1</code> and <code>target.weight1</code>. Note that the <code>target</code> option is ignored when a set of knots and weights are passed.</p>
<p>Here is an example of using custom weights to replicate the conditional LATE from above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pmodel &lt;-<span class="st"> </span>r<span class="op">$</span>propensity<span class="op">$</span>model <span class="co"># returned from the previous run of ivmte</span>
xeval =<span class="st"> </span><span class="dv">2</span> <span class="co"># x = xeval is the group that is conditioned on</span>
px &lt;-<span class="st"> </span><span class="kw">mean</span>(ivmteSimData<span class="op">$</span>x <span class="op">==</span><span class="st"> </span>xeval) <span class="co"># probability that x = xeval</span>
z.from =<span class="st"> </span><span class="dv">1</span>
z.to =<span class="st"> </span><span class="dv">3</span>
weight1  &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    <span class="cf">if</span> (x <span class="op">!=</span><span class="st"> </span>xeval) {
        <span class="kw">return</span>(<span class="dv">0</span>)
    } <span class="cf">else</span> {
        xz.from &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> xeval, <span class="dt">z =</span> z.from)
        xz.to &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> xeval, <span class="dt">z =</span> z.to)
        p.from &lt;-<span class="st"> </span><span class="kw">predict</span>(pmodel, <span class="dt">newdata =</span> xz.from, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
        p.to &lt;-<span class="st"> </span><span class="kw">predict</span>(pmodel, <span class="dt">newdata =</span> xz.to, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
        <span class="kw">return</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>((p.to <span class="op">-</span><span class="st"> </span>p.from) <span class="op">*</span><span class="st"> </span>px))
    }
}
weight0 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    <span class="kw">return</span>(<span class="op">-</span><span class="kw">weight1</span>(x))
}
## Define knots (same for treated and control)
knot1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    xz.from &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">z =</span> z.from)
    p.from &lt;-<span class="st"> </span><span class="kw">predict</span>(pmodel, <span class="dt">newdata =</span> xz.from, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
    <span class="kw">return</span>(p.from)
}
knot2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
    xz.to &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">z =</span> z.to)
    p.to &lt;-<span class="st"> </span><span class="kw">predict.glm</span>(pmodel, <span class="dt">newdata =</span> xz.to, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
    <span class="kw">return</span>(p.to)
}

args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>d<span class="op">*</span>z,
             <span class="dt">target.knots0 =</span> <span class="kw">c</span>(knot1, knot2),
             <span class="dt">target.knots1 =</span> <span class="kw">c</span>(knot1, knot2),
             <span class="dt">target.weight0 =</span> <span class="kw">c</span>(<span class="dv">0</span>, weight0, <span class="dv">0</span>),
             <span class="dt">target.weight1 =</span> <span class="kw">c</span>(<span class="dv">0</span>, weight1, <span class="dv">0</span>),
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(u<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.8419396, -0.2913049]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>The knot specification here is the same for both the treated and untreated weights. It specifies two knots that depend on whether <code>x == 2</code>, so that there are four knots total when accounting for 0 and 1, which are always included automatically. These four knots divide the interval between 0 and 1 into three regions. The first region is from 0 to the value of the propensity score when evaluated at <code>x</code> and <code>z.from</code>. The second region is between this point and the propensity score evaluated at <code>x</code> and <code>z.to</code>. The third and final region is from this point up to 1.</p>
<p>Since the knot specification creates three regions, three weight functions must be passed. Here, the weights in the first and third regions are set to 0 regardless of the value of <code>x</code> by just passing a scalar <code>0</code>. The weights in the second region are only non-zero when <code>x == 2</code>, in which case they are equal to the inverse of the distance between the second and third knot points. Thus, the weighting scheme applies equal weight to compliers with <code>x == 2</code>, and zero weight to all others. As expected, the resulting bounds match those that we computed above using <code>target == late</code>.</p>
<h3 id="specifying-the-iv--like-estimands">Specifying the IV--Like Estimands</h3>
<p>The IV--like estimands refer to the moments in the data that are used to fit the model. In <strong>ivmte</strong> these are restricted to be only moments that can be expressed as the coefficient in either a linear regression (LR) or two stage least squares (TSLS) regression of the outcome variable on the other variables in the dataset.</p>
<p>There are three aspects that can be changed, which we discuss in order subsequently. First, one can specify one or multiple LR and TSLS formulas from which moments are used. By default, all moments from each formula are used. Second, one can specify that only certain moments from a formula are used. Third, one can specify a subset of the data on which the formula is run, which provides an easy way to nonparametrically condition on observables.</p>
<h4 id="list-of-linear-model-formulas">List of Linear Model Formulas</h4>
<p>The required <code>ivlike</code> option expects a list of R formulas. All of our examples up to now have had a single LR. However, one can include multiple LRs, as well as TSLS regressions using the <code>|</code> syntax familiar from the <strong>AER</strong> package. Each formula must have the same variable on the left-hand side, which is how the outcome variable gets inferred. For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  <span class="kw">c</span>(y <span class="op">~</span><span class="st"> </span>(z <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(z <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(z <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span>x,
                         y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span>x,
                         y <span class="op">~</span><span class="st"> </span>d <span class="op">|</span><span class="st"> </span>z),
             <span class="dt">target =</span> <span class="st">&quot;ate&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">1</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">1</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; Warning: The following IV-like specifications do not include the treatment</span>
<span class="co">#&gt; variable: 1. This may result in fewer independent moment conditions than</span>
<span class="co">#&gt; expected.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.6427017, -0.3727193]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>There are 10 moments being fit in this specification. Five of these moments correspond to the constant term, the coefficients on the three dummies <code>(z == 1)</code>, <code>(z == 2)</code> and <code>(z == 3)</code>, and the coefficient on <code>x</code> from the first linear regression. There are three more coefficients from the second regression of <code>y</code> on <code>d</code>, <code>x</code>, and a constant. Finally, there are two moments from the TSLS (simple IV in this case) regression of <code>y</code> on <code>d</code> and a constant, using <code>z</code> and a constant as instruments.</p>
<h4 id="using-only-subcomponents">Using Only Subcomponents</h4>
<p>The default behavior of <code>ivmte</code> is to use all of the moments from each formula included in <code>ivlike</code>. There are reasons one might not want to do this, such as if certain moments are estimated poorly (i.e. with substantial statistical error). For more information, see the discussions in Mogstad, Santos, and Torgovitsky (2018) and Mogstad and Torgovitsky (2018).</p>
<p>One can tell <code>ivmte</code> to only include certain moments and not others by passing the <code>components</code> option. This option expects a list of the same length as the list passed to <code>ivlike</code>. Each component of the list is itself a list that contains the variable names for the coefficients to be included from that formula. The list should be declared using the <code>l</code> function, which is a generalization of the <code>list</code> function. The <code>l</code> function allows the user to list variables and expressions without having to enclose them by quotation marks. For example, the following includes the coefficients on the intercept and <code>x</code> from the first formula, the coefficient on <code>d</code> from the second formula, and all coefficients in the third formula.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;components&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">l</span>(<span class="kw">c</span>(intercept, x), <span class="kw">c</span>(d), )
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.6865291, -0.2573525]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<p>Note that <code>intercept</code> is a reserved word that is used to specify the coefficient on the constant term. If the function <code>list</code> is used to pass the <code>components</code> option, an error will follow.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args[[<span class="st">&quot;components&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(intercept, x), <span class="kw">c</span>(d), )
<span class="co">#&gt; Error in eval(expr, envir, enclos): object 'intercept' not found</span>
args[[<span class="st">&quot;components&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;intercept&quot;</span>, <span class="st">&quot;x&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;d&quot;</span>), <span class="st">&quot;&quot;</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; Error in terms.formula(fi, ...): invalid model formula in ExtractVars</span></code></pre></div>
<h4 id="subsetting">Subsetting</h4>
<p>The formulas can be run conditional on certain subgroups by adding the <code>subset</code> option. This option expects a list of logical statements with the same length as <code>ivlike</code> declared using the <code>l</code> function. One can use the entire data by leaving the statement blank, or inserting a tautology such as <code>1 == 1</code>. For example, the following would run the first regression only on observations with <code>x</code> less than or equal to 9, the second regression on the entire sample, and the third (TSLS) formula only on those observations that have <code>z</code> equal to 1 or 3.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  <span class="kw">c</span>(y <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x,
                         y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span>x,
                         y <span class="op">~</span><span class="st"> </span>d <span class="op">|</span><span class="st"> </span>z),
             <span class="dt">subset =</span> <span class="kw">l</span>(x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">9</span>, <span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, z <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)),
             <span class="dt">target =</span> <span class="st">&quot;ate&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">uSplines</span>(<span class="dt">degree =</span> <span class="dv">3</span>, <span class="dt">knots =</span> <span class="kw">c</span>(.<span class="dv">25</span>, .<span class="dv">5</span>, .<span class="dv">75</span>)) <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; Warning: The following IV-like specifications do not include the treatment</span>
<span class="co">#&gt; variable: 1. This may result in fewer independent moment conditions than</span>
<span class="co">#&gt; expected.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.6697228, -0.3331582]</span>
<span class="co">#&gt; Audit terminated successfully after 2 rounds.</span>
<span class="co">#&gt; </span></code></pre></div>
<h3 id="specifying-the-propensity-score">Specifying the Propensity Score</h3>
<p>The procedure implemented by <code>ivmte</code> requires first estimating the propensity score, that is, the probability that the binary treatment variable is 1, conditional on the instrument and other covariates. This must be specified with the <code>propensity</code> option, which expects a formula. The treatment variable is inferred to be the variable on the left-hand side of the <code>propensity</code>. The default is to estimate the formula as a logit model via the <code>glm</code> command, but this can be changed to <code>&quot;linear&quot;</code> or <code>&quot;probit&quot;</code> with the <code>link</code> option.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ivmte</span>(<span class="dt">data =</span> AE,
                 <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
                 <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">ivlike =</span> worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
                 <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">link =</span> <span class="st">&quot;probit&quot;</span>,
                 <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.100781, -0.0825274]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span></code></pre></div>
<h3 id="point-identified-models">Point Identified Models</h3>
<p>The default of the <code>ivmte</code> command is to estimate bounds on the target parameter. If one believes the model is in fact point identified, then <code>point == TRUE</code> can be included as an option. Point identification will typically occur when <code>ivlike</code>, <code>components</code> and <code>subset</code> are such that they have more (non-redundant) components than there are free parameters in <code>m0</code> and <code>m1</code>. Bounds in this case will typically shrink to a point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(z),
             <span class="dt">target =</span> <span class="st">&quot;ate&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(z),
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.5349027, -0.5349027]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round.</span>
<span class="co">#&gt; </span>
args[[<span class="st">&quot;point&quot;</span>]] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Point estimate of the target parameter: -0.5389508</span></code></pre></div>
<p>Notice that even though <code>point = FALSE</code> and <code>point = TRUE</code> provide a single number for the target parameter in this scenario, that number is slightly different. The reason is that, for computational reasons, <code>point = TRUE</code> uses the usual quadratic loss, while <code>point = FALSE</code> uses absolute deviations loss. One should use <code>point = TRUE</code> if the model is point identified, since it computes confidence intervals and specification tests (discussed ahead) in a well-understood way. The default when <code>point = TRUE</code> is to use the optimal two-step GMM weighting, however the identity weighting can be computed by passing <code>point.eyeweight = TRUE</code>.</p>
<h3 id="confidence-intervals">Confidence Intervals</h3>
<p>The <code>ivmte</code> command does provide functionality for constructing confidence regions, although this is turned off by default, since it can be computationally expensive. To turn it on, set <code>bootstraps</code> to be a positive integer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">ivmte</span>(<span class="dt">data =</span> AE,
                 <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
                 <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u <span class="op">+</span><span class="st"> </span>yob,
                 <span class="dt">ivlike =</span> worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
                 <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
                 <span class="dt">bootstraps =</span> <span class="dv">50</span>,
                 <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.09835591, -0.08285941]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bootstrapped confidence intervals (backward):</span>
<span class="co">#&gt;     90%: [-0.2013432, -0.01624443]</span>
<span class="co">#&gt;     95%: [-0.2185989, -0.003729633]</span>
<span class="co">#&gt;     99%: [-0.2300391, 0.0006812143]</span>
<span class="co">#&gt; p-value: 0.04</span>
<span class="co">#&gt; Number of bootstraps: 50</span></code></pre></div>
<p>Other options relevent to confidence region construction are <code>bootstraps.m</code>, which indicates the number of observations to draw from the sample on each bootstrap replication, and <code>bootstraps.replace</code> to indicate whether these observations should be drawn with or without replacement. The default is to set <code>bootstraps.m</code> to the sample size of the observed data with <code>bootstraps.replace = TRUE</code>. This corresponds to the usual nonparametric bootstrap. Choosing <code>bootstraps.m</code> to be smaller than the sample size and setting <code>bootstraps.replace</code> to be <code>TRUE</code> or <code>FALSE</code> corresponds to the &quot;m out of n&quot; bootstrap or subsampling, respectively. Regardless of these settings, two types of confidence regions are constructed following the terminology of Andrews and Han (2009); see Shea and Torgovitsky (2019) for more detail, references, and important theoretical caveats to the procedures.</p>
<p>Confidence regions can also be constructed when <code>point == TRUE</code> in a similar way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> AE,
             <span class="dt">target =</span> <span class="st">&quot;att&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u,
             <span class="dt">ivlike =</span> worked <span class="op">~</span><span class="st"> </span>morekids <span class="op">+</span><span class="st"> </span>samesex <span class="op">+</span><span class="st"> </span>morekids<span class="op">*</span>samesex,
             <span class="dt">propensity =</span> morekids <span class="op">~</span><span class="st"> </span>samesex,
             <span class="dt">point =</span> <span class="ot">TRUE</span>,
             <span class="dt">bootstraps =</span> <span class="dv">50</span>,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Point estimate of the target parameter: -0.09160436</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bootstrapped confidence intervals (nonparametric):</span>
<span class="co">#&gt;     90%: [-0.1869028, -0.02510774]</span>
<span class="co">#&gt;     95%: [-0.2077314, -0.02507778]</span>
<span class="co">#&gt;     99%: [-0.227466, 0.0001054838]</span>
<span class="co">#&gt; p-value: 0.08</span>
<span class="co">#&gt; Number of bootstraps: 50</span></code></pre></div>
<p>The p-value reported in both cases is for the null hypothesis that the target parameter is equal to 0, which we infer here by finding the largest confidence region that does not contain 0. By default, <code>ivmte</code> returns 99%, 95%, and 90% confidence intervals. This can be changed with the <code>levels</code> option.</p>
<h3 id="specification-tests">Specification Tests</h3>
<p>The moment-based framework implemented by <code>ivmte</code> is amenable to specification tests. These tests are based on whether the minimum value of the criterion function is statistically different from 0. In the point identified case, this is the well known GMM overidentification test (Hansen 1982). Here, we implement it via bootstrapping as discussed by Hall and Horowitz (1996), because the moments depend on the estimated propensity score which is estimated in a first stage. In the partially identified case, we implement the misspecification test discussed by Bugni, Canay, and Shi (2015). The specification tests are automatically conducted when <code>bootstraps</code> is positive and the minimum criterion value in the sample problem is larger than 0. However, it can be turned off by setting <code>specification.test = FALSE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">args &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">data =</span> ivmteSimData,
             <span class="dt">ivlike =</span>  y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(z),
             <span class="dt">target =</span> <span class="st">&quot;ate&quot;</span>,
             <span class="dt">m0 =</span> <span class="op">~</span><span class="st"> </span>u,
             <span class="dt">m1 =</span> <span class="op">~</span><span class="st"> </span>u,
             <span class="dt">m0.dec =</span> <span class="ot">TRUE</span>,
             <span class="dt">m1.dec =</span> <span class="ot">TRUE</span>,
             <span class="dt">propensity =</span> d <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(z),
             <span class="dt">bootstraps =</span> <span class="dv">50</span>,
             <span class="dt">noisy =</span> <span class="ot">FALSE</span>)
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; </span>
<span class="co">#&gt; Bounds on the target parameter: [-0.6189484, -0.6189484]</span>
<span class="co">#&gt; Audit terminated successfully after 1 round. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bootstrapped confidence intervals (backward):</span>
<span class="co">#&gt;     90%: [-0.6411833, -0.6011875]</span>
<span class="co">#&gt;     95%: [-0.64164, -0.5966297]</span>
<span class="co">#&gt;     99%: [-0.6465837, -0.5944238]</span>
<span class="co">#&gt; p-value: 0</span>
<span class="co">#&gt; Bootstrapped specification test p-value: 0.36</span>
<span class="co">#&gt; Number of bootstraps: 50</span>

args[[<span class="st">&quot;ivlike&quot;</span>]] &lt;-<span class="st"> </span>y <span class="op">~</span><span class="st"> </span>d <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(z) <span class="op">+</span><span class="st"> </span>d<span class="op">*</span><span class="kw">factor</span>(z) <span class="co"># many more moments</span>
args[[<span class="st">&quot;point&quot;</span>]] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
r &lt;-<span class="st"> </span><span class="kw">do.call</span>(ivmte, args)
<span class="co">#&gt; Warning: If argument 'point' is set to TRUE, then shape restrictions on m0</span>
<span class="co">#&gt; and m1 are ignored, and the audit procedure is not implemented.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Point estimate of the target parameter: -0.5559325</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Bootstrapped confidence intervals (nonparametric):</span>
<span class="co">#&gt;     90%: [-0.6066197, -0.5112431]</span>
<span class="co">#&gt;     95%: [-0.6101133, -0.5086833]</span>
<span class="co">#&gt;     99%: [-0.6147004, -0.4743232]</span>
<span class="co">#&gt; p-value: 0</span>
<span class="co">#&gt; Bootstrapped J-test p-value: 0.44</span>
<span class="co">#&gt; Number of bootstraps: 50</span></code></pre></div>
<h2 id="help-feature-requests-and-bug-reports">Help, Feature Requests and Bug Reports</h2>
<p>Please post an issue on the <a href="https://github.com/jkcshea/ivmte/issues">GitHub repository</a>.</p>
<h2 id="references">References</h2>
<p>Andrews, Donald W. K., and Sukjin Han. 2009. Invalidity of the Bootstrap and the M Out of N Bootstrap for Confidence Interval Endpoints Defined by Moment Inequalities. <em>Econometrics Journal</em> 12. Blackwell Publishing Ltd: S172S199. <a href="http://dx.doi.org/10.1111/j.1368-423X.2008.00265.x" class="uri">http://dx.doi.org/10.1111/j.1368-423X.2008.00265.x</a>.</p>
<p>Angrist, Joshua D., and William N. Evans. 1998. Children and Their Parents Labor Supply: Evidence from Exogenous Variation in Family Size. <em>The American Economic Review</em> 88 (3). American Economic Association: 45077.</p>
<p>Bugni, Federico A., Ivan A. Canay, and Xiaoxia Shi. 2015. Specification Tests for Partially Identified Models Defined by Moment Inequalities. <em>Journal of Econometrics</em> 185 (1): 25982. <a href="http://www.sciencedirect.com/science/article/pii/S0304407614002577" class="uri">http://www.sciencedirect.com/science/article/pii/S0304407614002577</a>.</p>
<p>Hall, Peter, and Joel L. Horowitz. 1996. Bootstrap Critical Values for Tests Based on Generalized-Method-of-Moments Estimators. <em>Econometrica</em> 64 (4). The Econometric Society: 891916.</p>
<p>Hansen, Lars Peter. 1982. Large Sample Properties of Generalized Method of Moments Estimators. <em>Econometrica</em> 50 (4). The Econometric Society: 102954.</p>
<p>Heckman, James J., and Edward Vytlacil. 2005. Structural Equations, Treatment Effects, and Econometric Policy Evaluation. <em>Econometrica</em> 73 (3). Blackwell Publishing Ltd: 669738. <a href="http://dx.doi.org/10.1111/j.1468-0262.2005.00594.x" class="uri">http://dx.doi.org/10.1111/j.1468-0262.2005.00594.x</a>.</p>
<p>Imbens, Guido W., and Joshua D. Angrist. 1994. Identification and Estimation of Local Average Treatment Effects. <em>Econometrica</em> 62 (2): 46775.</p>
<p>Mogstad, Magne, and Alexander Torgovitsky. 2018. Identification and Extrapolation of Causal Effects with Instrumental Variables. <em>Annual Review of Economics</em> 10 (1). Annual Reviews. <a href="https://dx.doi.org/10.1146/annurev-economics-101617-041813" class="uri">https://dx.doi.org/10.1146/annurev-economics-101617-041813</a>.</p>
<p>Mogstad, Magne, Andres Santos, and Alexander Torgovitsky. 2018. Using Instrumental Variables for Inference About Policy Relevant Treatment Parameters. <em>Econometrica</em> 86 (5). The Econometric Society: 15891619. <a href="https://dx.doi.org/10.3982/ecta15463" class="uri">https://dx.doi.org/10.3982/ecta15463</a>.</p>
<p>Shea, Joshua Ka Chun, and Alexander Torgovitsky. 2019. Ivmte: An R Package for Implementing Marginal Treatment Effect Methods. <em>Working Paper</em>.</p>

</body>
</html>
